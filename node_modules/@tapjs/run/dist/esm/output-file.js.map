{"version":3,"file":"output-file.js","sourceRoot":"","sources":["../../src/output-file.ts"],"names":[],"mappings":"AAEA,OAAO,EAAE,QAAQ,EAAE,MAAM,UAAU,CAAA;AACnC,OAAO,EAAE,UAAU,EAAE,MAAM,QAAQ,CAAA;AACnC,OAAO,EAAE,iBAAiB,EAAE,MAAM,SAAS,CAAA;AAC3C,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,MAAM,WAAW,CAAA;AAE5C,MAAM,CAAC,MAAM,UAAU,GAAG,CACxB,CAAM,EACN,MAAoB,EACpB,WAAoB,EACpB,EAAE;IACF,MAAM,UAAU,GAAG,MAAM,CAAC,GAAG,CAAC,aAAa,CAAC,CAAA;IAC5C,IAAI,UAAU,EAAE;QACd,UAAU,CAAC,OAAO,CAAC,OAAO,CAAC,UAAU,CAAC,CAAC,CAAC,CAAA;QACxC,MAAM,CAAC,GAAG,IAAI,QAAQ,CAAiB,EAAE,QAAQ,EAAE,MAAM,EAAE,CAAC,CAAA;QAC5D,IAAI,CAAC,WAAW,EAAE;YAChB,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,CAAA;YACtB,CAAC,CAAC,QAAQ,EAAE,CAAA;SACb;QACD,CAAC,CAAC,IAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,UAAU,CAAC,CAAC,CAAC,CAAA;QAC9C,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAA;KACV;AACH,CAAC,CAAA","sourcesContent":["import { LoadedConfig } from '@tapjs/config'\nimport { TAP } from '@tapjs/core'\nimport { Minipass } from 'minipass'\nimport { mkdirpSync } from 'mkdirp'\nimport { createWriteStream } from 'node:fs'\nimport { dirname, resolve } from 'node:path'\n\nexport const outputFile = (\n  t: TAP,\n  config: LoadedConfig,\n  hasReporter: boolean\n) => {\n  const outputFile = config.get('output-file')\n  if (outputFile) {\n    mkdirpSync(dirname(resolve(outputFile)))\n    const m = new Minipass<string, string>({ encoding: 'utf8' })\n    if (!hasReporter) {\n      m.pipe(process.stdout)\n      t.register()\n    }\n    m.pipe(createWriteStream(resolve(outputFile)))\n    t.pipe(m)\n  }\n}\n"]}