{"version":3,"file":"after.js","sourceRoot":"","sources":["../../src/after.ts"],"names":[],"mappings":"AAEA,OAAO,EAAE,eAAe,EAAE,MAAM,kBAAkB,CAAA;AAClD,OAAO,EAAE,OAAO,EAAE,MAAM,MAAM,CAAA;AAC9B,MAAM,IAAI,GAAG,OAAO,CAAC,QAAQ,CAAA;AAE7B,MAAM,CAAC,MAAM,QAAQ,GAAG,CACtB,CAAM,EACN,IAAc,EACd,MAAoB,EACpB,EAAE;IACF,MAAM,KAAK,GAAG,MAAM,CAAC,GAAG,CAAC,OAAO,CAAC,CAAA;IACjC,IAAI,KAAK,EAAE;QACT,CAAC,CAAC,KAAK,CAAC,KAAK,IAAI,EAAE;YACjB,MAAM,IAAI,OAAO,CAAO,GAAG,CAAC,EAAE;gBAC5B,eAAe,CACb,IAAI,EACJ,CAAC,GAAG,IAAI,EAAE,OAAO,CAAC,KAAK,CAAC,CAAC,EACzB,CAAC,IAAI,EAAE,MAAM,EAAE,EAAE;oBACf,GAAG,EAAE,CAAA;oBACL,IAAI,IAAI,IAAI,MAAM;wBAAE,OAAM;oBAC1B,OAAO,KAAK,CAAA;gBACd,CAAC,CACF,CAAA;YACH,CAAC,CAAC,CAAA;QACJ,CAAC,CAAC,CAAA;QACF,OAAO,OAAO,CAAC,KAAK,CAAC,CAAA;KACtB;AACH,CAAC,CAAA","sourcesContent":["import { LoadedConfig } from '@tapjs/config'\nimport { TAP } from '@tapjs/core'\nimport { foregroundChild } from 'foreground-child'\nimport { resolve } from 'path'\nconst node = process.execPath\n\nexport const runAfter = (\n  t: TAP,\n  argv: string[],\n  config: LoadedConfig\n) => {\n  const after = config.get('after')\n  if (after) {\n    t.after(async () => {\n      await new Promise<void>(res => {\n        foregroundChild(\n          node,\n          [...argv, resolve(after)],\n          (code, signal) => {\n            res()\n            if (code || signal) return\n            return false\n          }\n        )\n      })\n    })\n    return resolve(after)\n  }\n}\n"]}