{"version":3,"file":"repl.js","sourceRoot":"","sources":["../../src/repl.ts"],"names":[],"mappings":"AACA,OAAO,EAAE,GAAG,EAAE,MAAM,kBAAkB,CAAA;AACtC,OAAO,EAAE,WAAW,EAAE,MAAM,oBAAoB,CAAA;AAChD,OAAO,EAAE,OAAO,EAAE,MAAM,MAAM,CAAA;AAC9B,OAAO,EAAE,SAAS,EAAE,MAAM,UAAU,CAAA;AACpC,OAAO,EAAE,IAAI,EAAE,MAAM,iBAAiB,CAAA;AAEtC,MAAM,CAAC,MAAM,IAAI,GAAG,KAAK,EAAE,IAAc,EAAE,MAAoB,EAAE,EAAE;IACjE,IAAI,GAAG,CAAC,SAAS,KAAK,GAAG,EAAE;QACzB,OAAO,CAAC,KAAK,CAAC,iCAAiC,CAAC,CAAA;QAChD,OAAO,CAAC,QAAQ,GAAG,CAAC,CAAA;QACpB,OAAM;KACP;IACD,MAAM,GAAG,GAAG,OAAO,CAAC,MAAM,CAAC,OAAO,EAAE,kBAAkB,CAAC,CAAA;IACvD,MAAM,CAAC,GAAG,IAAI,IAAI,CAChB,MAAM,EACN,OAAO,CAAC,KAAK,EACb,OAAO,CAAC,MAAM,EACd,MAAM,WAAW,CAAC,IAAI,CAAC,EAAE,GAAG,EAAE,CAAC,CAChC,CAAA;IACD,CAAC,CAAC,KAAK,EAAE,CAAA;IACT,IAAI,IAAI,CAAC,MAAM,EAAE;QACf,MAAM,MAAM,GAAG,MAAM,CAAC,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAA;QACnD,IAAI,MAAM,KAAK,SAAS,EAAE;YACxB,OAAO,CAAC,GAAG,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,CAAA;YAC9B,CAAC,CAAC,IAAI,EAAE,aAAa,EAAE,CAAA;SACxB;KACF;AACH,CAAC,CAAA","sourcesContent":["import { LoadedConfig } from '@tapjs/config'\nimport { env } from '@tapjs/core/proc'\nimport { ProcessInfo } from '@tapjs/processinfo'\nimport { resolve } from 'path'\nimport { stringify } from 'tap-yaml'\nimport { Repl } from './repl/index.js'\n\nexport const repl = async (args: string[], config: LoadedConfig) => {\n  if (env._TAP_REPL === '1') {\n    console.error('you are already in the tap repl')\n    process.exitCode = 1\n    return\n  }\n  const dir = resolve(config.globCwd, '.tap/processinfo')\n  const r = new Repl(\n    config,\n    process.stdin,\n    process.stdout,\n    await ProcessInfo.load({ dir })\n  )\n  r.start()\n  if (args.length) {\n    const result = await r.parseCommand(args.join(' '))\n    if (result !== undefined) {\n      console.log(stringify(result))\n      r.repl?.displayPrompt()\n    }\n  }\n}\n"]}