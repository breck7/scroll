{"version":3,"file":"replay.js","sourceRoot":"","sources":["../../src/replay.ts"],"names":[],"mappings":"AAGA,OAAO,EAAE,OAAO,EAAe,MAAM,aAAa,CAAA;AAClD,OAAO,EAAE,QAAQ,EAAE,OAAO,EAAE,MAAM,WAAW,CAAA;AAC7C,OAAO,EAAE,gBAAgB,EAAE,MAAM,yBAAyB,CAAA;AAE1D,MAAM,CAAC,MAAM,MAAM,GAAG,KAAK,EACzB,IAAc,EACd,MAAoB,EACpB,EAAE;IACF,OAAO,gBAAgB,CACrB,IAAI,EACJ,MAAM;IACN,4CAA4C;IAC5C,CAAC,CAAC,EAAE,CAAC,CAAC,EACN,GAAG,EAAE,GAAE,CAAC,EACR,KAAK,EAAE,CAAC,EAAE,IAAI,EAAE,EAAE;QAChB,MAAM,IAAI,GAAG,QAAQ,CAAC,MAAM,CAAC,OAAO,EAAE,IAAI,CAAC,CAAA;QAC3C,MAAM,QAAQ,GAAG,OAAO,CACtB,MAAM,CAAC,OAAO,EACd,mBAAmB,EACnB,IAAI,GAAG,MAAM,CACd,CAAA;QACD,MAAM,QAAQ,GAAG,CAAC,CAAC,IAAI,GAAG,CAAC,CAAA;QAC3B,MAAM,IAAI,GAAgB;YACxB,GAAG,EAAE,MAAM,CAAC,OAAO;YACnB,QAAQ;YACR,IAAI;YACJ,QAAQ;SACT,CAAA;QACD,OAAO,CAAC,CAAC,GAAG,CAAuB,OAAO,EAAE,IAAI,EAAE,MAAM,CAAC,CAAA;IAC3D,CAAC,CACF,CAAA;AACH,CAAC,CAAA","sourcesContent":["// Replay the provided tests from the .tap/test-results folder if\n// present.\nimport { LoadedConfig } from '@tapjs/config'\nimport { TapFile, TapFileOpts } from '@tapjs/core'\nimport { relative, resolve } from 'node:path'\nimport { executeTestSuite } from './execute-test-suite.js'\n\nexport const replay = async (\n  args: string[],\n  config: LoadedConfig\n) => {\n  return executeTestSuite(\n    args,\n    config,\n    // no setup or plugins to apply in this case\n    t => t,\n    () => {},\n    async (t, file) => {\n      const name = relative(config.globCwd, file)\n      const filename = resolve(\n        config.globCwd,\n        '.tap/test-results',\n        name + '.tap'\n      )\n      const buffered = t.jobs > 1\n      const opts: TapFileOpts = {\n        cwd: config.globCwd,\n        buffered,\n        name,\n        filename,\n      }\n      return t.sub<TapFile, TapFileOpts>(TapFile, opts, replay)\n    }\n  )\n}\n"]}