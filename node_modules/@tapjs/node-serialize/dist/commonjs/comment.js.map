{"version":3,"file":"comment.js","sourceRoot":"","sources":["../../src/comment.ts"],"names":[],"mappings":";;;AAEA,+BAA6B;AAC7B,qDAA4C;AAGrC,MAAM,aAAa,GAAG,CAC3B,MAA2B,EAC3B,QAAmC,EACnC,EAAE;IACF,OAAO,SAAS,OAAO,CAAa,GAAG,IAAW;QAChD,MAAM,OAAO,GAAG,IAAA,aAAM,EAAC,GAAG,IAAI,CAAC,CAAA;QAC/B,MAAM,KAAK,GAAG,QAAQ,CAAC,GAAG,CAAC,IAAI,CAAC,CAAA;QAChC,MAAM,CAAC,GAAG;YACR,GAAG,IAAA,0BAAS,EAAC,OAAO,CAAC;YACrB,OAAO,EAAE,IAAI,CAAC,YAAY;YAC1B,OAAO;SACR,CAAA;QACD,IAAI,KAAK;YAAE,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC,CAAA;;YACnB,MAAM,CAAC,UAAU,CAAC,CAAC,CAAC,CAAA;IAC3B,CAAC,CAAA;AACH,CAAC,CAAA;AAfY,QAAA,aAAa,iBAezB","sourcesContent":["import { Base } from '@tapjs/core'\nimport { TestStreamSerialize } from '@tapjs/error-serdes'\nimport { format } from 'util'\nimport { locFromAt } from './loc-from-at.js'\nimport { TestMap } from './test-map.js'\n\nexport const commentMethod = (\n  stream: TestStreamSerialize,\n  diagsMap: TestMap<DiagnosticData[]>\n) => {\n  return function comment(this: Base, ...args: any[]) {\n    const message = format(...args)\n    const diags = diagsMap.get(this)\n    const m = {\n      ...locFromAt(comment),\n      nesting: this.nestingLevel,\n      message,\n    }\n    if (diags) diags.push(m)\n    else stream.diagnostic(m)\n  }\n}\n"]}