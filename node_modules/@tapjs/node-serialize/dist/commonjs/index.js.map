{"version":3,"file":"index.js","sourceRoot":"","sources":["../../src/index.ts"],"names":[],"mappings":";;;AACA,sCAAiC;AACjC,iDAA0C;AAE1C,IAAI,UAAU,GAAG,KAAK,CAAA;AACf,MAAM,MAAM,GAAkB,CAAC,CAAC,EAAE;IACvC,IACE,CAAC,CAAC,IAAI,KAAK,KAAK;QAChB,CAAC,CAAC,CAAC,MAAM;QACT,UAAG,CAAC,iBAAiB,KAAK,UAAU;QACpC,CAAC,UAAU,EACX;QACA,6DAA6D;QAC7D,UAAU,GAAG,IAAI,CAAA;QACjB,UAAG,CAAC,iBAAiB,GAAG,OAAO,CAAA;QAC/B,IAAA,wBAAS,EAAC,CAAQ,CAAC,CAAA;KACpB;IACD,OAAO,EAAE,CAAA;AACX,CAAC,CAAA;AAbY,QAAA,MAAM,UAalB","sourcesContent":["import type { TAP, TapPlugin } from '@tapjs/core'\nimport { env } from '@tapjs/core'\nimport { serialize } from './serialize.js'\n\nlet serialized = false\nexport const plugin: TapPlugin<{}> = t => {\n  if (\n    t.name === 'TAP' &&\n    !t.parent &&\n    env.NODE_TEST_CONTEXT === 'child-v8' &&\n    !serialized\n  ) {\n    // make sure we don't serialize anything else in this process\n    serialized = true\n    env.NODE_TEST_CONTEXT = 'child'\n    serialize(t as TAP)\n  }\n  return {}\n}\n"]}