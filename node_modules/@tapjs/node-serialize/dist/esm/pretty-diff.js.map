{"version":3,"file":"pretty-diff.js","sourceRoot":"","sources":["../../src/pretty-diff.ts"],"names":[],"mappings":"AAAA,+DAA+D;AAC/D,0BAA0B;AAC1B,EAAE;AACF,gEAAgE;AAChE,6DAA6D;AAE7D,MAAM,KAAK,GAAG;IACZ,GAAG,EAAE,wBAAwB;IAC7B,KAAK,EAAE,2CAA2C;IAClD,GAAG,EAAE,6CAA6C;IAClD,GAAG,EAAE,2CAA2C;IAChD,KAAK,EAAE,2CAA2C;CAC1C,CAAA;AAEV,OAAO,EAAE,IAAI,EAAE,MAAM,aAAa,CAAA;AAElC,MAAM,IAAI,GAAG,IAAI,CAAC,GAAG,CAAC,EAAE,EAAE,IAAI,CAAC,GAAG,CAAC,IAAI,EAAE,MAAM,CAAC,OAAO,IAAI,EAAE,EAAE,EAAE,CAAC,CAAC,CAAA;AAEnE,MAAM,CAAC,MAAM,UAAU,GAAG,CAAC,IAAS,EAAE,EAAE;IACtC,IAAI,CAAC,IAAI,IAAI,OAAO,IAAI,KAAK,QAAQ;QAAE,OAAO,EAAE,CAAA;IAChD,OAAO,IAAI;SACR,OAAO,EAAE;SACT,OAAO,CAAC,QAAQ,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,OAAO,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;SAChD,OAAO,CAAC,UAAU,EAAE,CAAC,CAAC,EAAE,CAAC,KAAK,CAAC,GAAG,GAAG,CAAC,GAAG,KAAK,CAAC,GAAG,CAAC;SACnD,OAAO,CAAC,UAAU,EAAE,CAAC,CAAC,EAAE,CAAC,KAAK,CAAC,KAAK,GAAG,CAAC,GAAG,KAAK,CAAC,GAAG,CAAC;SACrD,OAAO,CAAC,UAAU,EAAE,CAAC,CAAC,EAAE,CAAC,KAAK,CAAC,GAAG,GAAG,CAAC,GAAG,KAAK,CAAC,GAAG,CAAC;SACnD,OAAO,CAAC,SAAS,EAAE,CAAC,CAAC,EAAE,CAAC,KAAK,CAAC,KAAK,GAAG,CAAC,GAAG,KAAK,CAAC,GAAG,CAAC,CAAA;AACzD,CAAC,CAAA","sourcesContent":["// This is a WAY less advanced version of the diff highlighting\n// that the reporter does.\n//\n// We use this when serializing the diagnostics for node --test,\n// because it all has to be concatenated into one big string.\n\nconst theme = {\n  end: '\\x1B[39m\\x1B[49m\\x1b[m',\n  green: '\\x1B[48;2;58;117;0m\\x1B[38;2;242;255;229m',\n  red: '\\x1B[48;2;172;62;163m\\x1B[38;2;255;229;241m',\n  ctx: '\\x1B[48;2;34;34;34m\\x1B[38;2;117;158;239m',\n  white: '\\x1B[48;2;51;51;51m\\x1B[38;2;204;204;204m',\n} as const\n\nimport { proc } from '@tapjs/core'\n\nconst cols = Math.max(25, Math.min(proc?.stdout.columns || 75, 75))\n\nexport const prettyDiff = (diff: any) => {\n  if (!diff || typeof diff !== 'string') return ''\n  return diff\n    .trimEnd()\n    .replace(/^.*$/gm, s => s.trimEnd().padEnd(cols))\n    .replace(/^\\-.+$/gm, s => theme.red + s + theme.end)\n    .replace(/^\\+.+$/gm, s => theme.green + s + theme.end)\n    .replace(/^\\@.+$/gm, s => theme.ctx + s + theme.end)\n    .replace(/^ .+$/gm, s => theme.white + s + theme.end)\n}\n"]}